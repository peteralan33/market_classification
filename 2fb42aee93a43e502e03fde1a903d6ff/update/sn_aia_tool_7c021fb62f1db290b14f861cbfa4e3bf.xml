<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sn_aia_tool">
    <sn_aia_tool action="INSERT_OR_UPDATE">
        <active>true</active>
        <description>This tool is used when the user requests a detailed investigation of a image attachment, or a summarization of the image attachments on a record that may contains details relating to unmatched trades.</description>
        <input_schema>[{"name":"attachment_sys_ids","description":"list of sys_ids for the attachments to use as a document for summarization"}]</input_schema>
        <name>Summarize attachments for unmatched trades</name>
        <record_type>custom</record_type>
        <script><![CDATA[(function(inputs) {

    function normalizeInputData(inputData) {
    if (
        inputData === null ||
        inputData === "{}" ||
        (typeof inputData === "object" && !Array.isArray(inputData) && Object.keys(inputData).length === 0)
    ) {
        return null;
    }

    if (typeof inputData === "string") {
        try {
            var parsedData = JSON.parse(inputData);
            if (Array.isArray(parsedData)) {
                return parsedData;
            }
            return [parsedData];
        } catch (error) {
            return [inputData];
        }
    }

    if (Array.isArray(inputData)) {
        return inputData;
    }

    if (typeof inputData === "object") {
        return Object.values(inputData);
    }

    throw new Error("Invalid format: inputData must be an object, array, or a valid JSON string.");
    }

    var docintelGenAIConstants = new sn_docintel_gen_ai.DocintelGenAIConstants();
    var attSumAPI = new sn_docintel_gen_ai.AttachmentSummarizer();
    var taskDefinitionSysId = docintelGenAIConstants.TRADE_ECP_AGENT_TASK_DEF_ID;

    var attachmentIds = normalizeInputData(inputs.attachment_sys_ids);
    var taskID = attSumAPI.processAttachmentSysIds(attachmentIds, taskDefinitionSysId);
    return JSON.stringify({
        "docintel_task_id": taskID
    });

    })(inputs);]]></script>
        <sys_class_name>sn_aia_tool</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-11-23 00:40:29</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>7c021fb62f1db290b14f861cbfa4e3bf</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>Summarize attachments for unmatched trades</sys_name>
        <sys_overrides/>
        <sys_package display_value="Pete's Market Classifications Toolkit" source="x_snc_pab_mc_tkit">2fb42aee93a43e502e03fde1a903d6ff</sys_package>
        <sys_policy/>
        <sys_scope display_value="Pete's Market Classifications Toolkit">2fb42aee93a43e502e03fde1a903d6ff</sys_scope>
        <sys_update_name>sn_aia_tool_7c021fb62f1db290b14f861cbfa4e3bf</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-11-23 00:41:01</sys_updated_on>
        <target_document/>
        <target_document_table>sn_aia_tool</target_document_table>
        <type>script</type>
    </sn_aia_tool>
</record_update>
